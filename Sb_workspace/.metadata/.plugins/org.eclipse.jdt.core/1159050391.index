scode_languageserver_types_1.Position.create(position.line, characterStart - 1), position);
                    for (var entity in htmlEntities_1.entities) {
                        if (strings_1.endsWith(entity, ';')) {
                            var label = '&' + entity;
                            result.items.push({
                                label: label,
                                kind: vscode_languageserver_types_1.CompletionItemKind.Keyword,
                                documentation: localize('entity.propose', "Character entity representing '" + htmlEntities_1.entities[entity] + "'"),
                                textEdit: vscode_languageserver_types_1.TextEdit.replace(range, label),
                                insertTextFormat: vscode_languageserver_types_1.InsertTextFormat.PlainText
                            });
                        }
                    }
                }
                return result;
            }
            function suggestDoctype(replaceStart, replaceEnd) {
                var range = getReplaceRange(replaceStart, replaceEnd);
                result.items.push({
                    label: '!DOCTYPE',
                    kind: vscode_languageserver_types_1.CompletionItemKind.Property,
                    documentation: 'A preamble for an HTML document.',
                    textEdit: vscode_languageserver_types_1.TextEdit.replace(range, '!DOCTYPE html>'),
                    insertTextFormat: vscode_languageserver_types_1.InsertTextFormat.PlainText
                });
            }
            var token = scanner.scan();
            while (token !== htmlLanguageTypes_1.TokenType.EOS && scanner.getTokenOffset() <= offset) {
                switch (token) {
                    case htmlLanguageTypes_1.TokenType.StartTagOpen:
                        if (scanner.getTokenEnd() === offset) {
                            var endPos = scanNextForEndPos(htmlLanguageTypes_1.TokenType.StartTag);
                            if (position.line === 0) {
                                suggestDoctype(offset, endPos);
                            }
                            return collectTagSuggestions(offset, endPos);
                        }
                        break;
                    case htmlLanguageTypes_1.TokenType.StartTag:
                        if (scanner.getTokenOffset() <= offset && offset <= scanner.getTokenEnd()) {
                            return collectOpenTagSuggestions(scanner.getTokenOffset(), scanner.getTokenEnd());
                        }
                        currentTag = scanner.getTokenText();
                        break;
                    case htmlLanguageTypes_1.TokenType.AttributeName:
                        if (scanner.getTokenOffset() <= offset && offset <= scanner.getTokenEnd()) {
                            return collectAttributeNameSuggestions(scanner.getTokenOffset(), scanner.getTokenEnd());
                        }
                        currentAttributeName = scanner.getTokenText();
                        break;
                    case htmlLanguageTypes_1.TokenType.DelimiterAssign:
                        if (scanner.getTokenEnd() === offset) {
                            var endPos = scanNextForEndPos(htmlLanguageTypes_1.TokenType.AttributeValue);
                            return collectAttributeValueSuggestions(offset, endPos);
                        }
                        break;
                    case htmlLanguageTypes_1.TokenType.AttributeValue:
                        if (scanner.getTokenOffset() <= offset && offset <= scanner.getTokenEnd()) {
                            return collectAttributeValueSuggestions(scanner.getTokenOffset(), scanner.getTokenEnd());
                        }
                        break;
                    case htmlLanguageTypes_1.TokenType.Whitespace:
                        if (offset <= scanner.getTokenEnd()) {
                            switch (scanner.getScannerState()) {
                                case htmlLanguageTypes_1.ScannerState.AfterOpeningStartTag:
                                    var startPos = scanner.getTokenOffset();
                                    var endTagPos = scanNextForEndPos(htmlLanguageTypes_1.TokenType.StartTag);
                                    return collectTagSuggestions(startPos, endTagPos);
                                case htmlLanguageTypes_1.ScannerState.WithinTag:
                                case htmlLanguageTypes_1.ScannerState.AfterAttributeName:
                                    return collectAttributeNameSuggestions(scanner.getTokenEnd());
                                case htmlLanguageTypes_1.ScannerState.BeforeAttributeValue:
                                    return collectAttributeValueSuggestions(scanner.getTokenEnd());
                                case htmlLanguageTypes_1.ScannerState.AfterOpeningEndTag:
                                    return collectCloseTagSuggestions(scanner.getTokenOffset() - 1, false);
                                case htmlLanguageTypes_1.ScannerState.WithinContent:
                                    return collectInsideContent();
                            }
                        }
                        break;
                    case htmlLanguageTypes_1.TokenType.EndTagOpen:
                        if (offset <= scanner.getTokenEnd()) {
                            var afterOpenBracket = scanner.getTokenOffset() + 1;
                            var endOffset = scanNextForEndPos(htmlLanguageTypes_1.TokenType.EndTag);
                            return collectCloseTagSuggestions(afterOpenBracket, false, endOffset);
                        }
                        break;
                    case htmlLanguageTypes_1.TokenType.EndTag:
                        if (offset <= scanner.getTokenEnd()) {
                            var start = scanner.getTokenOffset() - 1;
                            while (start >= 0) {
                                var ch = text.charAt(start);
                                if (ch === '/') {
                                    return collectCloseTagSuggestions(start, false, scanner.getTokenEnd());
                                }
                                else if (!isWhiteSpace(ch)) {
                                    break;
                                }
                                start--;
                            }
                        }
                        break;
                    case htmlLanguageTypes_1.TokenType.StartTagClose:
                        if (offset <= scanner.getTokenEnd()) {
                            if (currentTag) {
                                return collectAutoCloseTagSuggestion(scanner.getTokenEnd(), currentTag);
                            }
                        }
                        break;
                    case htmlLanguageTypes_1.TokenType.Content:
                        if (offset <= scanner.getTokenEnd()) {
                            return collectInsideContent();
                        }
                        break;
                    default:
                        if (offset <= scanner.getTokenEnd()) {
                            return result;
                        }
                        break;
                }
                token = scanner.scan();
            }
            return result;
        };
        HTMLCompletion.prototype.doTagComplete = function (document, position, htmlDocument) {
            var offset = document.offsetAt(position);
            if (offset <= 0) {
                return null;
            }
            var char = document.getText().charAt(offset - 1);
            if (char === '>') {
                var node = htmlDocument.findNodeBefore(offset);
                if (node && node.tag && !fact_1.isVoidElement(node.tag) && node.start < offset && (!node.endTagStart || node.endTagStart > offset)) {
                    var scanner = htmlScanner_1.createScanner(document.getText(), node.start);
                    var token = scanner.scan();
                    while (token !== htmlLanguageTypes_1.TokenType.EOS && scanner.getTokenEnd() <= offset) {
                        if (token === htmlLanguageTypes_1.TokenType.StartTagClose && scanner.getTokenEnd() === offset) {
                            return "$0</" + node.tag + ">";
                        }
                        token = scanner.scan();
                    }
                }
            }
            else if (char === '/') {
                var node = htmlDocument.findNodeBefore(offset);
                while (node && node.closed) {
                    node = node.parent;
                }
                if (node && node.tag) {
                    var scanner = htmlScanner_1.createScanner(document.getText(), node.start);
                    var token = scanner.scan();
                    while (token !== htmlLanguageTypes_1.TokenType.EOS && scanner.getTokenEnd() <= offset) {
                        if (token === htmlLanguageTypes_1.TokenType.EndTagOpen && scanner.getTokenEnd() === offset) {
                            return node.tag + ">";
                        }
                        token = scanner.scan();
                    }
                }
            }
            return null;
        };
        return HTMLCompletion;
    }());
    exports.HTMLCompletion = HTMLCompletion;
    function isQuote(s) {
        return /^["']*$/.test(s);
    }
    function isWhiteSpace(s) {
        return /^\s*$/.test(s);
    }
    function isFollowedBy(s, offset, intialState, expectedToken) {
        var scanner = htmlScanner_1.createScanner(s, offset, intialState);
        var token = scanner.scan();
        while (token === htmlLanguageTypes_1.TokenType.Whitespace) {
            token = scanner.scan();
        }
        return token === expectedToken;
    }
    function getWordStart(s, offset, limit) {
        while (offset > limit && !isWhiteSpace(s[offset - 1])) {
            offset--;
        }
        return offset;
    }
    function getWordEnd(s, offset, limit) {
        while (offset < limit && !isWhiteSpace(s[offset])) {
            offset++;
        }
        return offset;
    }
});
//# sourceMappingURL=htmlCompletion.js.map                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             INDX( 	 áxS           (      è       d   C l p   o         «     ˜ ‚     Œ«     ~¡‹×%ôØ‚È‹×%ôØ‚È‹×%ôØ‚È‹×%ôØ       ä                A d d i t i o n a l I n f o C o n t r o l l e r $ 1 . c l a s s l e c ¡«     Ğ ¼     Œ«     ÿ²Œ×%ôØÚŒ×%ôØÚŒ×%ôØÚŒ×%ôØ       À              = A d d i t i o n a l I n f o C o n t r o l l e r $ D e f a u l t P r e s e n t e r C o n t r o l C r e a t o r . c l a s s     œ«     À ¬     Œ«     õÅ€×%ôØÄ‹×%ôØt,‹×%ôØÄ‹×%ôØ       C              5 A d  i t i o n a l I n f o C o n t r o l l e r $ T a b l e S e l e c t i o n L i s t e n e r . c l a s s %ôØ›«            Œ«     ş€×%ôØş€×%ôØş€×%ôØş€×%ôØ       E              & A d d i t i o n a l I n f o C o n t r o l l e r $ T i m e r $ 1 . c l a s s a Ÿ«     ¨ ’     Œ«     ¯Œ×%ôØ¯Œ×%ôØİ=Œ×%ôØ¯Œ×%ôØ       4	              ( A d d i t i o n a l I n f o C o n t r o l l e r $ T i m e r $ 2 $ 1 . c l a s s      ¢«            Œ«     ×%ôØ(×%ôØ(×%ôØ(×%ôØ       7	             & A d d i t i o n a l I n f o C o n t r o l l e r $ T i m e r $ 2 . c l a s s a £«            Œ«     Jv×%ôØJv×%ôØD×%ôØJv×%ôØ       ™              & A d d i t i o n a l I n f o C o n t r o l l e r $ T i m e r $ 3 . c l a s s a š«            Œ«     àP€×%ôØx€×%ôØx€×%ôØx€×%ôØ       e              & A d d i t i o n a l I n f o C o n t r o l l e r $ T i m e r $ 4 . c l a s s a ™«            Œ«     é)€×%ôØé)€×%ôØàP€×%ôØé)€×%ôØ       —              & A d d i t i o n a l I n f o  o n t r o l l e r $ T i m e r $ 5 . c l a s s a ˜«     ¨ ”     Œ«     ¢Û×%ôØ¢Û×%ôØ¹€×%ôØ¢Û×%ôØ       ş              ) A d d i t i o n a l I n f o C o n t r o l l e r $ T i m e r $ T a s k . c l a s s %ôØ«       Š     Œ«     [S‹×%ôØdz‹×%ôØdz‹×%ôØdz‹×%ôØ                      $ A d d i t i o n a l I n f o C o n t r o l l e r $ T i m e r . c l a s s       «      ~     Œ«     ÊdŒ×%ôØÊdŒ×%ôØÓ‹Œ×%ôØÊdŒ×%ôØ        º               A d d i t i o n a l I n f o C o n t r o l l e r . c  a s s                Œ«     …9×%ôØ…9×%ôØ(ş’×%ôØ…9×%ôØ       M              4 A s y n c C o m p l e t i o n P r o p o s a l P o p u p $ C o m p u t i n g P r o p o s a l . c l a s s ~×%ôØ§«     À ª     Œ«     .&“×%ôØ.&“×%ôØ.&“×%ôØ.&“×%ôØ       Õ              4 A s y n c C o m p l e t i o n P r o p o s a l P o p u p $ P o p u p V i s i b l e T i m e r . c l a s s n f o ¨«     ˜ †     Œ«     ÿM“×%ôØbr“×%ôØbr“×%ôØbr“×%ôØ P      NG              " A s y n c C o m p l e t i o n P r o  o s a l P o p u p . c l a s s t ±«     ˆ v     Œ«     ¸–×%ôØ¸–×%ôØ¸–×%ôØ¸–×%ôØ       ‚               B o l d S t y l e r P r o v i d e r $ 1 . c l a s s o °«     ˆ r     Œ«     ‘–×%ôØ‘–×%ôØ‘–×%ôØ‘–×%ôØ       ‹               B o l d S t y l e r P r o v i d e r . c l a s s n f o ¹«     ˆ r     Œ«     ìš×%ôØìš×%ôØëAš×%ôØìš×%ôØ                      C o m p l e t i o n P r o p o s a l . c l a s s i o n Å«      €     Œ«     ¬å›×%ôØ¬å›×%ôØ¬å›×%ôØ¬å›×%ôØ       Ô              C o m p l e t i o n P r o p o s a l P o p u p $ 1 . c l a s s Ã«      €     Œ«     œ—›×%ôØœ—›×%ôØ¢¾›×%ôØœ—›×%ôØ       K               C o m p l e t i o n P r o p o s a l P o p u p $ 2 . c l a s s Ä«     À ®     Œ«     ¢¾›×%ôØ¢¾›×%ôØ¬å›×%ôØ¢¾›×%ôØ       à              6 C o m p l e t i o n P r o p o s a l P o p u p $ P r o p o s a l S e l e c t i o n H a n d l e r . c l a s s  ¶«     ¨ –     Œ«     {—×%ôØ{—×%ôØ{—×%ôØ{—×%ôØ       0              * C o m p o s i t e C  n t e x t I n f o r m a t i o n V a l i d a t o r . c l a s s t ²«     ˆ r     Œ«     $ß–×%ôØ$ß–×%ôØ$ß–×%ôØ$ß–×%ôØ       å               C o n t e n t A s s i s t E v e n t . c l a s s       ¿«     ¨ ’     Œ«     d"›×%ôØd"›×%ôØd"›×%ôØd"›×%ôØ 0      u+              ( C o n t e n t A s s i s t S u b j e c t C o n t r o l A d a p t e r . c l a s s I C o               Œ«     …9×%ôØ…9×%ôØ…9×%ôØ…9×%ôØ       M               s t a g e d 5 0 9 7 . t m p                                INDX( 	 0öS          (   è  è           c   l Øn         ’«      €     Œ«     ?£~×%ôØ?£~×%ôØ>Ê~×%ôØ?£~×%ôØ       y               C o n t e x t I n f o r m a t i o n P o p u p $ 1 . c l a s s ‘«      €     Œ«     Q|~×%ôØQ|~×%ôØQ|~×%ôØQ|~×%ôØ       ï               C o n t e x t I n f o r m a t i o n P o p u p $ 2 . c l a s s «      €     Œ«     Î‘}×%ôØÎ‘}×%ôØK¹}×%ôØÎ‘}×%ôØ       X               C o n t e x t I n f o r m a t i o n P o p u p $ 3 . c l a s s «      €    Œ«     ü~×%ôØü~×%ôØ.~×%ôØü~×%ôØ                      C o n t e x t I n f o r m a t i o n P o p u p $ 4 . c l a s s «     ¨ –     Œ«     äß}×%ôØäß}×%ôØäß}×%ôØäß}×%ôØ       Æ              * C o n t e x t I n f o r m a t i o n P o p u p $ C o n t e x t F r a m e . c l a s s G«      |     Œ«     šC}×%ôØ´j}×%ôØ´j}×%ôØ´j}×%ôØ `      ÆP               C o n t e x t I n f o r m a t i o n P o p u p . c l a s s     ³«     ˜ „     Œ«     R—×%ôØR—×%ôØR—×%ôØR—×%ôØ       Ğ             ! C o n t e x t I n f o r m a t i o n V a l i d a t o r . c l a s s s s ¼«     ˆ t     Œ«     Gš×%ôØGš×%ôØ·š×%ôØGš×%ôØx      s               I C o m p l e t i o n L i s t e n e r . c l a s s i o ½«     ˜ †     Œ«     0Òš×%ôØ0Òš×%ôØ0Òš×%ôØ0Òš×%ôØ                    " I C o m p l e t i o n L i s t e n e r E x t e n s i o n . c l a s s s •«     ˜ ˆ     Œ«     f?×%ôØf?×%ôØpf×%ôØf?×%ôØ                    # I C o m p l e t i o n L i s t e n e r E x t e n s i o n 2 .  l a s s ­«     ˆ t     Œ«     Ü÷•×%ôØÎ–×%ôØÎ–×%ôØÎ–×%ôØ                      I C o m p l e t i o n P r o p o s a l . c l a s s i o ´«     ˜ †     Œ«     h-—×%ôØh-—×%ôØh-—×%ôØh-—×%ôØ€      z              " I C o m p l e t i o n P r o p o s a l E x t e n s i o n . c l a s s s “«     ˜ ˆ     Œ«     >Ê~×%ôØIñ~×%ôØIñ~×%ôØIñ~×%ôØĞ      Ì              # I C o m p l e t i o n P r o p o s a l E x t e n s i o n 2 . c l a s s İ«     ˜ ˆ     Œ«     AŸ×%ôØ?¶Ÿ×%ôØ?¶Ÿ×%ôØ?¶Ÿ×%ôØÀ     ½              # I C o m p l e t i o n P r o p o s a l E x t e n s i o n 3 . c l a s s »«     ˜ ˆ     Œ«     iš×%ôØGš×%ôØGš×%ôØGš×%ôØØ       Ñ               # I C o m p l e t i o n P r o p o s a l E x t e n s i o n 4 . c l a s s               Œ«     Y™“×%ôØY™“×%ôØY™“×%ôØY™“×%ôØ`      Z              # I C o m p l e t i o n P r o p o s a l E x t e n s i o n 7 . c l a s s ª«      €     Œ«     Y™“×%ôØ²}•×%ôØ²}•×%ôØ²}•×%ôØ8      4               I C o m p l e t i o n P r o p o s a  S o r t e r . c l a s s ”«     € p     Œ«     Z×%ôØZ×%ôØZ×%ôØZ×%ôØ                       I C o n t e n t A s s i s t a n t . c l a s s ¬«     ˜ ‚     Œ«     óÍ•×%ôØóÍ•×%ôØÜ÷•×%ôØóÍ•×%ôØ       ü                 I C o n t e n t A s s i s t a n t E x t e n s i o n . c l a s s s    ««     ˜ „     Œ«     d§•×%ôØd§•×%ôØóÍ•×%ôØd§•×%ôØè      á              ! I C o n t e n t A s s i s t a n t E x t e n s i o n 2 . c l a s s    µ«     ˜ „     Œ«     T—×%ôØT—×%ôØT—×%ôØT—×%ô                     ! I C o n t e n t A s s i s t a n t E x t e n s i o n 3 . c l a s s     ·«     ˜ „     Œ«     Ò¢—×%ôØÒ¢—×%ôØÌ™×%ôØÒ¢—×%ôØ       ü               ! I C o n t e n t A s s i s t a n t E x t e n s i o n 4 . c l a s s     ¸«      |     Œ«     Ì™×%ôØKô™×%ôØKô™×%ôØKô™×%ôØ       Ğ               I C o n t e n t A s s i s t P r o c e s s o r . c l a s s    —«     ˆ t     Œ«     ´×%ôØ´×%ôØ´×%ôØ´×%ôØ`      \               I C o n t e x t I n f o r m a t i o  . c l a s s     º«     ˜ †     Œ«     ëAš×%ôØiš×%ôØiš×%ôØiš×%ôØà       Ü               " I C o n t e x t I n f o r m a t i o n E x t e n s i o n . c l a s s  ¯«     € p     Œ«     j–×%ôØj–×%ôØj–×%ôØj–×%ôØ       _               J F a c e T e x t M e s s a g e s . c l a s s ®«     x d     Œ«     Î–×%ôØaA–×%ôØaA–×%ôØaA–×%ôØ        Œ               P o p u p C l o s e r . c l a s s                                                                                                  INDX( 	 YûS          (     è       s    Øe             ¤«     ˜ ˆ     Œ«     XÄ×%ôØXÄ×%ôØXÄ×%ôØXÄ×%ôØ       ş               # I C o m p l e t i o n P r o p o s a l E x t e n s i o n 6 . c l a s s ©«     ˜ ˆ     Œ«     Y™“×%ôØY™“×%ôØY™“×%ôØY™“×%ôØ`      Z              # I C o m p l e t i o n P r o p o s a l E x t e n s i o n 7 . c l a s s ª«      €     Œ«     Y™“×%ôØ²}•×%ôØ²}•×%ôØ²}•×%ôØ8      4               I C o m p l e t i o n P r o p o s a l S o r t e r . c l a s  ”«     € p     Œ«     Z×%ôØZ×%ôØZ×%ôØZ×%ôØ                       I C o n t e n t A s s i s t a n t . c l a s s ¬«     ˜ ‚     Œ«     óÍ•×%ôØóÍ•×%ôØÜ÷•×%ôØóÍ•×%ôØ       ü                 I C o n t e n t A s s i s t a n t E x t e n s i o n . c l a s s s    ««     